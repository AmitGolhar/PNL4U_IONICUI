<div class="club-requests-container ion-padding admin-dark-bg">

  <h2 class="section-title">Club Requests Management</h2>

  <!-- ðŸŒˆ Filter Tabs -->
  <ion-segment [(ngModel)]="selectedStatus" (ionChange)="loadRequests()" class="dark-segment">
    <ion-segment-button value="all">All</ion-segment-button>
    <ion-segment-button value="pending">Pending</ion-segment-button>
    <ion-segment-button value="approved">Approved</ion-segment-button>
    <ion-segment-button value="rejected">Rejected</ion-segment-button>
  </ion-segment>

  <!-- ðŸ”¹ Loading -->
  <div *ngIf="loading" class="loading-text">Loading requests...</div>

  <!-- ðŸ”¹ Scrollable Dark Table -->
  <div *ngIf="!loading && requests.length > 0" class="table-wrapper">
    <table class="club-requests-table">
      <thead>
        <tr>
          <th>Club Name</th>
          <th>Owner</th>
          <th>City</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Type</th>
          <th>Package</th>
          <th>Status</th>
          <th>Submitted</th>
          <th>Photo</th>
          <th>Actions</th>
          <th>Reviewed By</th>
          <th>Remarks</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let req of requests" [class.pending]="req.status === 'PENDING'">
          <td>{{ req.clubName }}</td>
          <td>{{ req.ownerName }}</td>
          <td>{{ req.city }}</td>
          <td>{{ req.email }}</td>
          <td>{{ req.phoneNumber }}</td>
          <td>{{ req.clubType }}</td>
          <td>{{ req.preferredPackage }}</td>
          <td>
            <span [class]="req.status.toLowerCase()">{{ req.status }}</span>
          </td>
          <td>{{ req.submittedDate | date: 'medium' }}</td>
          <td>
            <img
              *ngIf="req.photo"
              [src]="'data:image/jpeg;base64,' + req.photo"
              alt="Club Photo"
              class="club-photo"
              (click)="openImageModal('data:image/jpeg;base64,' + req.photo)"
            />
          </td>
          <td>
            <div *ngIf="req.status === 'PENDING'" class="btn-group">
              <ion-button color="success" size="small" (click)="approve(req)">Approve</ion-button>
              <ion-button color="danger" size="small" (click)="reject(req)">Reject</ion-button>
            </div>
          </td>
          <td>{{ req.reviewedBy || '-' }}</td>
          <td>{{ req.reviewRemarks || '-' }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- ðŸ”¹ No Data -->
  <div *ngIf="!loading && requests.length === 0" class="no-data">
    <ion-icon name="alert-circle-outline"></ion-icon>
    <p>No requests found for this category.</p>
  </div>

  <!-- ðŸ–¼ï¸ Image Modal -->
  <ion-modal [isOpen]="imageModalOpen" (didDismiss)="closeImageModal()" cssClass="image-modal">
    <ng-template>
      <div class="image-modal-content">
        <ion-icon name="close-circle" class="close-icon" (click)="closeImageModal()"></ion-icon>
        <img [src]="selectedImage" alt="Club Large Photo" class="modal-image" />
      </div>
    </ng-template>
  </ion-modal>

</div>
