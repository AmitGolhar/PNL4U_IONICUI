<ion-header translucent>
  <ion-toolbar>
    <ion-title>Wallet & Offers</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding gradient-bg">
  <!-- WALLET SUMMARY -->
  <div class="wallet-summary" *ngIf="wallet">
    <h2>ðŸ’° â‚¹{{ wallet.balance | number : '1.2-2' }}</h2>
    <p>Loyalty Level: Level {{ wallet.loyaltyLevelId }}</p>
    <small>Last updated: {{ wallet.lastUpdated | date: 'medium' }}</small>
  </div>

  <!-- TABS -->
  <ion-segment [(ngModel)]="activeTab" class="auth-tabs">
    <ion-segment-button value="wallet">
      <ion-label>Transactions</ion-label>
    </ion-segment-button>
    <ion-segment-button value="offers">
      <ion-label>Offers</ion-label>
    </ion-segment-button>
  </ion-segment>

  <!-- TRANSACTIONS -->
  <div *ngIf="activeTab === 'wallet'">
    <ion-card *ngFor="let txn of transactions" class="txn-card">
      <ion-card-content>
        <div class="txn-row">
          <span class="desc">{{ txn.description }}</span>
          <span class="amt" [ngClass]="{ credit: txn.type==='CREDIT', debit: txn.type==='DEBIT' }">
            {{ txn.type === 'CREDIT' ? '+' : '-' }}â‚¹{{ txn.amount }}
          </span>
        </div>
        <p class="txn-date">{{ txn.date | date: 'short' }}</p>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- OFFERS -->
  <div *ngIf="activeTab === 'offers'">
    <ion-card *ngFor="let offer of offers" class="offer-card">
      <ion-card-header>
        <ion-card-title>{{ offer.title }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>{{ offer.description }}</p>
        <p *ngIf="offer.discountPercent">Discount: {{ offer.discountPercent }}%</p>
        <p *ngIf="offer.cashbackAmount">Cashback: â‚¹{{ offer.cashbackAmount }}</p>
        <div class="btn-group">
          <ion-button
            *ngIf="userRole === 'USER'"
            fill="outline"
            size="small"
            (click)="redeemOffer(offer)"
            >Redeem</ion-button
          >
          <ion-button
            *ngIf="userRole === 'CLUBADMIN'"
            size="small"
            color="success"
            (click)="createOffer()"
            >Create Offer</ion-button
          >
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
